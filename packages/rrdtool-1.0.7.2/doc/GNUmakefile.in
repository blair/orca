####
#### Sorry, but this one will only work with GNU make ... 
####

# things that the GNU standards document suggests all makefiles
# should have.
SHELL = /bin/sh
.SUFFIXES:
.SUFFIXES: .c .o .pl .pm .pod .html .man .1 .3 .txt

# variables we got from configure
# (you can mess with these, if you want)

###
### Things you might NOT want to play with ... 
###
VER = `date +%Y%m%d.%H`

POD = rrdtool.pod rrdlast.pod rrdcreate.pod rrdupdate.pod rrdgraph.pod RRDs.pm RRDp.pm \
	rrdfetch.pod rrddump.pod rrdtune.pod rrdresize.pod

MAN = $(POD:.pod=.1) $(POD:.pl=.1) $(POD:.pm=.3) 
TXT = $(MAN:.1=.txt) $(POD:.3=.txt)
HTML = $(POD:.pod=.html) $(POD:.pl=.html) $(POD:.pm=.html) 


all: link txt man html


.pod.1:
	pod2man --release=$(VER) --center=rrdtool $<  > $@

.pm.3:
	pod2man --release=$(VER) --center=rrdtool $<  > $@

.pl.1:
	pod2man --release=$(VER) --center=rrdtool $<  > $@

.1.txt:
	nroff -man -Tlp $< > $@

.3.txt:
	nroff -man -Tlp $< > $@

.pod.html:
	pod2html --infile=$< --outfile=$@ --noindex --htmlroot=. --podpath=. --title=$*

.pl.html:
	pod2html --infile=$< --outfile=$@ --noindex --htmlroot=. --podpath=. --title=$*

.pm.html:
	pod2html --infile=$< --outfile=$@ --noindex --htmlroot=. --podpath=. --title=$*

RRDs.pm:
	ln -s ../perl-shared/RRDs.pm .

RRDp.pm:
	ln -s ../perl-piped/RRDp.pm .

link: RRDp.pm RRDs.pm

man: $(MAN)

html: $(HTML)

txt: $(TXT)

clean:  
	-rm *.txt *.html *.1 *.3

realclean:	clean
	-rm -f GNUmakefile
