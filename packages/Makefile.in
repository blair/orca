@SET_MAKE@

PERL			= @PERL@
CFLAGS			= @CFLAGS@
digest_md5_dir		= @DIGEST_MD5_DIR@
math_interpolate_dir	= @MATH_INTERPOLATE_DIR@
rrdtool_dir		= @RRDTOOL_DIR@
storable_dir		= @STORABLE_DIR@

MAKE_DIGEST_MD5		= @MAKE_DIGEST_MD5@
MAKE_MATH_INTERPOLATE	= @MAKE_MATH_INTERPOLATE@
MAKE_RRDTOOL		= @MAKE_RRDTOOL@
MAKE_STORABLE		= @MAKE_STORABLE@
MAKE_TARGETS		= $(MAKE_DIGEST_MD5) $(MAKE_MATH_INTERPOLATE) $(MAKE_RRDTOOL) $(MAKE_STORABLE)

TEST_DIGEST_MD5		= @TEST_DIGEST_MD5@
TEST_MATH_INTERPOLATE	= @TEST_MATH_INTERPOLATE@
TEST_RRDTOOL		= @TEST_RRDTOOL@
TEST_STORABLE		= @TEST_STORABLE@
TEST_TARGETS		= $(TEST_DIGEST_MD5) $(TEST_MATH_INTERPOLATE) $(TEST_RRDTOOL) $(TEST_STORABLE)

INSTALL_DIGEST_MD5	= @INSTALL_DIGEST_MD5@
INSTALL_MATH_INTERPOLATE= @INSTALL_MATH_INTERPOLATE@
INSTALL_RRDTOOL		= @INSTALL_RRDTOOL@
INSTALL_STORABLE	= @INSTALL_STORABLE@
INSTALL_TARGETS		= $(INSTALL_DIGEST_MD5) $(INSTALL_MATH_INTERPOLATE) $(INSTALL_RRDTOOL) $(INSTALL_STORABLE)

CLEAN_DIGEST_MD5	= @CLEAN_DIGEST_MD5@
CLEAN_MATH_INTERPOLATE	= @CLEAN_MATH_INTERPOLATE@
CLEAN_RRDTOOL		= @CLEAN_RRDTOOL@
CLEAN_STORABLE		= @CLEAN_STORABLE@
CLEAN_TARGETS		= $(CLEAN_DIGEST_MD5) $(CLEAN_MATH_INTERPOLATE) $(CLEAN_RRDTOOL) $(CLEAN_STORABLE)

DISTCLEAN_DIGEST_MD5	= @DISTCLEAN_DIGEST_MD5@
DISTCLEAN_MATH_INTERPOLATE = @DISTCLEAN_MATH_INTERPOLATE@
DISTCLEAN_RRDTOOL	= @DISTCLEAN_RRDTOOL@
DISTCLEAN_STORABLE	= @DISTCLEAN_STORABLE@
DISTCLEAN_TARGETS	= $(DISTCLEAN_DIGEST_MD5) $(DISTCLEAN_MATH_INTERPOLATE) $(DISTCLEAN_RRDTOOL) $(DISTCLEAN_STORABLE)

all:	Makefile

modules: Makefile $(MAKE_TARGETS)

make_digest_md5: $(digest_md5_dir)/Makefile
	(cd $(digest_md5_dir) && $(MAKE) OPTIMIZE="$(CFLAGS)")

$(digest_md5_dir)/Makefile: $(digest_md5_dir)/Makefile.PL $(PERL)
	(cd $(digest_md5_dir) && $(PERL) Makefile.PL)

make_math_interpolate: $(math_interpolate_dir)/Makefile
	(cd $(math_interpolate_dir) && $(MAKE) OPTIMIZE="$(CFLAGS)")

$(math_interpolate_dir)/Makefile: $(math_interpolate_dir)/Makefile.PL $(PERL)
	(cd $(math_interpolate_dir) && $(PERL) Makefile.PL)

make_rrdtool: $(rrdtool_dir)/Makefile $(PERL)
	(cd $(rrdtool_dir) && $(MAKE) CFLAGS="$(CFLAGS)")

$(rrdtool_dir)/Makefile: $(rrdtool_dir)/Makefile.in
	(cd .. && ./configure @CONFIGURE_COMMAND_LINE@)

make_storable: $(storable_dir)/Makefile
	(cd $(storable_dir) && $(MAKE) OPTIMIZE="$(CFLAGS)")

$(storable_dir)/Makefile: $(storable_dir)/Makefile.PL $(PERL)
	(cd $(storable_dir) && $(PERL) Makefile.PL)

test:

test_modules: $(TEST_TARGETS)

test_digest_md5: $(digest_md5_dir)/Makefile
	(cd $(digest_md5_dir) && $(MAKE) CFLAGS="$(CFLAGS)" test)

test_math_interpolate: $(math_interpolate_dir)/Makefile
	(cd $(math_interpolate_dir) && $(MAKE) test)

test_rrdtool: make_rrdtool
	(cd $(rrdtool_dir)/perl-shared && $(MAKE) CFLAGS="$(CFLAGS)" test)

test_storable: make_storable
	(cd $(storable_dir) && $(MAKE) CFLAGS="$(CFLAGS)" test)

install:

install_modules: $(INSTALL_TARGETS)

install_digest_md5: make_digest_md5
	(cd $(digest_md5_dir) && $(MAKE) install)

install_math_interpolate: make_math_interpolate
	(cd $(math_interpolate_dir) && $(MAKE) install)

install_rrdtool: make_rrdtool
	(cd $(rrdtool_dir)/perl-shared && $(MAKE) install)

install_storable: make_storable
	(cd $(storable_dir) && $(MAKE) install)

clean: $(CLEAN_TARGETS)

clean_digest_md5:
	@if test -r $(digest_md5_dir)/Makefile; then 			\
		echo '(cd $(digest_md5_dir); $(MAKE) clean';		\
		(cd $(digest_md5_dir); $(MAKE) clean);			\
	fi

clean_math_interpolate:
	@if test -r $(math_interpolate_dir)/Makefile; then 		\
		echo '(cd $(math_interpolate_dir); $(MAKE) clean)';	\
		(cd $(math_interpolate_dir); $(MAKE) clean);		\
	fi

clean_rrdtool:
	(cd $(rrdtool_dir) && $(MAKE) clean)

clean_storable:
	@if test -r $(storable_dir)/Makefile; then 			\
		echo '(cd $(storable_dir); $(MAKE) clean)';		\
		(cd $(storable_dir); $(MAKE) clean);			\
	fi

distclean: $(DISTCLEAN_TARGETS)

distclean_digest_md5:		clean_digest_md5

distclean_math_interpolate:	clean_math_interpolate

distclean_rrdtool:		clean_rrdtool
	(cd $(rrdtool_dir) && $(MAKE) distclean)

distclean_storable:		clean_storable

Makefile: Makefile.in
	(cd ..; ./config.status)
	$(MAKE)
