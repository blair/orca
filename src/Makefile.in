@SET_MAKE@

prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir		= @bindir@
MKDIR		= @MKDIR@
INSTALL		= @INSTALL@
PERL_HEAD	= @PERL_HEAD@
ORCALLATOR_DIR	= @ORCALLATOR_DIR@
RRD_DIR		= @RRD_DIR@
PERL_SCRIPTS	= orcallator_running orca orcallator_column
SHELL_SCRIPTS	= restart_orcallator stop_orcallator start_orcallator
TARGETS		= $(PERL_SCRIPTS) $(SHELL_SCRIPTS)

all:		$(TARGETS) migrate_to_orcallator

install: all
		$(MKDIR) $(bindir)
		@for file in $(TARGETS); do			\
			echo $(INSTALL) $$file $(bindir);	\
			$(INSTALL) $$file $(bindir);		\
		done

migrate:	migrate_to_orcallator
		./migrate_to_orcallator $(prefix) $(exec_prefix) $(bindir) $(libdir) $(ORCALLATOR_DIR) $(RRD_DIR)

clean:
		$(RM) $(TARGETS)

distclean:	clean
		$(RM) *.sh orcallator_running.pl Makefile

.SUFFIXES:	.pl .sh

.pl:		$(PERL_HEAD)
		cat $(PERL_HEAD) $< > $@
		chmod 0755 $@

.sh:
		cp $< $@
		chmod 0755 $@

Makefile:	Makefile.in
		(cd ..; ./config.status)
		$(MAKE)

orcallator_running.pl:		orcallator_running.pl.in
		(cd ..; ./config.status)
		$(MAKE)

restart_orcallator.sh:		restart_orcallator.sh.in
		(cd ..; ./config.status)
		$(MAKE)

start_orcallator.sh:		start_orcallator.sh.in
		(cd ..; ./config.status)
		$(MAKE)

stop_orcallator.sh:		stop_orcallator.sh.in
		(cd ..; ./config.status)
		$(MAKE)
